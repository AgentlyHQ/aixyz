---
title: "Agent Structure"
description: "Understand the app/ directory structure and how agents are defined"
---

## Directory Layout

Every aixyz agent follows the `app/` directory convention:

```
app/
  agent.ts            # Agent definition (required if no server.ts)
  server.ts           # Custom server (optional, overrides auto-generation)
  accepts.ts          # Custom x402 facilitator (optional)
  tools/
    weather.ts        # Tool implementations
    search.ts
    _helpers.ts       # Ignored â€” files starting with _ are skipped
  icon.png            # Agent icon (served as a static asset)
```

The build pipeline scans this directory to auto-generate a server with A2A, MCP, and x402 support.

## Agent Definition (`agent.ts`)

The agent file exports a default `ToolLoopAgent` using the Vercel AI SDK (`ai@^6`):

```typescript
import { openai } from "@ai-sdk/openai";

export default {
  model: openai("gpt-4o"),
  system: "You are a helpful travel assistant.",
};
```

The `ToolLoopAgentExecutor` wraps your agent definition and handles tool execution loops automatically.

## Tools (`tools/*.ts`)

Each `.ts` file in `app/tools/` defines a tool. Tools are automatically discovered and registered on both A2A and MCP endpoints.

```typescript
import { tool } from "ai";
import { z } from "zod";

export default tool({
  description: "Get the current weather for a city",
  parameters: z.object({
    city: z.string().describe("City name"),
  }),
  execute: async ({ city }) => {
    return { temperature: 72, condition: "sunny", city };
  },
});
```

<Note>
  Files starting with `_` (e.g., `_helpers.ts`) are ignored by the build pipeline. Use this convention for shared
  utilities.
</Note>

## Payment Configuration (`accepts`)

Agents and tools can export an `accepts` object to enable x402 payment gating:

```typescript
export const accepts: Accepts = {
  scheme: "exact",
  price: "$0.005",
};
```

If a tool or agent does not export `accepts`, it is registered on standard (non-payment-gated) endpoints.

## Custom Facilitator (`accepts.ts`)

The optional `app/accepts.ts` file lets you provide a custom x402 facilitator for payment verification, overriding the default behavior.

## Icon (`icon.png`)

Place an `icon.png` in `app/` to serve it as a static asset. This icon is referenced in the A2A agent card for agent discovery UIs.

## Next Steps

<CardGroup cols={2}>
  <Card title="Custom Server" icon="server" href="/guides/custom-server">
    Override auto-generation with your own Express server.
  </Card>
  <Card title="Configuration" icon="gear" href="/guides/configuration">
    Configure agent identity and payment settings.
  </Card>
</CardGroup>
