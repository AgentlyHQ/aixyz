---
title: "useA2A"
description: "Register A2A protocol endpoints on your server"
---

Registers the A2A (Agent-to-Agent) protocol endpoints on an `AixyzServer`. This sets up the agent card and JSON-RPC task handler.

```typescript
import { useA2A } from "aixyz/server/adapters/a2a";
```

## Signature

```typescript
function useA2A<TOOLS extends ToolSet>(
  app: AixyzServer,
  exports: {
    default: ToolLoopAgent<never, TOOLS>;
    accepts?: Accepts;
  },
  taskStore?: TaskStore,
): void;
```

| Parameter   | Type          | Default             | Description                                  |
| ----------- | ------------- | ------------------- | -------------------------------------------- |
| `app`       | `AixyzServer` | —                   | The server instance                          |
| `exports`   | `object`      | —                   | Agent module exports (`default` + `accepts`) |
| `taskStore` | `TaskStore`   | `InMemoryTaskStore` | Storage backend for A2A tasks                |

## Registered Endpoints

| Endpoint                       | Method | Description                                            |
| ------------------------------ | ------ | ------------------------------------------------------ |
| `/.well-known/agent-card.json` | GET    | Agent discovery card generated from config             |
| `/agent`                       | POST   | JSON-RPC task handler (x402-gated if `accepts` is set) |

## Behavior

- If `exports.accepts` is defined with `scheme: "exact"`, the `/agent` endpoint is gated behind x402 payment
- If `exports.accepts` is not defined, the agent is **not registered** — no endpoints are created

## Example

```typescript
import { AixyzServer } from "aixyz/server";
import { useA2A } from "aixyz/server/adapters/a2a";
import * as agent from "./agent";

const server = new AixyzServer();
await server.initialize();

// `agent` module exports: default (ToolLoopAgent) + accepts (Accepts)
useA2A(server, agent);
```
